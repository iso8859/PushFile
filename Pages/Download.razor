@page "/download/{token?}"
@using PushFile.Services
@inject IFileIndexService FileIndexService
@inject NavigationManager Navigation

<PageTitle>Download</PageTitle>

<div class="container mt-5">
 <div class="row justify-content-center">
 <div class="col-md-10">
 <div class="card shadow">
 <div class="card-header bg-dark text-white">
 <h4 class="mb-0">File Download</h4>
 </div>
 <div class="card-body">
 @if (!string.IsNullOrEmpty(token))
 {
 var path = FileIndexService.GetFilePath(token);
 if (path != null && System.IO.File.Exists(path))
 {
 <p>Direct download for: <strong>@Path.GetFileName(path)</strong></p>
 <a class="btn btn-success" href="@($"/download-file/{token}")" target="_blank">Download</a>
 }
 else
 {
 <div class="alert alert-warning">Invalid or expired download link.</div>
 }
 }
 
 <h5 class="mt-3">Browse uploaded files</h5>
 <ul class="list-group">
 @foreach (var f in FileIndexService.ListAllFiles())
 {
 <li class="list-group-item d-flex justify-content-between align-items-center">
 <span>@f</span>
 <a class="btn btn-sm btn-outline-primary" href="@($"/download-file-byname/{f}")" target="_blank">Download</a>
 </li>
 }
 </ul>
 </div>
 </div>
 </div>
 </div>
</div>

@code {
 [Parameter] public string? token { get; set; }
}
